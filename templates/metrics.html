<html>
	<head>
		<title>Bias metrics</title>
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/style/biaschart.css') }}">
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/style/dlchart.css') }}">
	</head>
	<body>
		<h1>Bias metrics</h1>
		<div>
			<div>
				<h2>Data metrics</h2>
				<b>Number of negatives (privileged)</b>: {{ data.privileged.num_negatives }}<br>
				<b>Number of positives (privileged)</b>: {{ data.privileged.num_positives }}<br>
				<b>Number of negatives (unprivileged)</b>: {{ data.unprivileged.num_negatives }}<br>
				<b>Number of positives (unprivileged)</b>: {{ data.unprivileged.num_positives }}<br>
				<b>Base rate</b>: {{ data.base_rate }}<br>
				<b>Statistical parity difference</b>: {{ data.statistical_parity_difference }}<br>
				<b>Consistency</b>: {{ data.consistency }}<br>
			</div>
			<div>
				<h2>Performance</h2>
				<b>Recall</b>: {{ performance.recall }}<br>
				<b>True negative rate</b>: {{ performance.true_negative_rate }}<br>
				<b>False positive rate</b>: {{ performance.false_positive_rate }}<br>
				<b>False negative rate</b>: {{ performance.false_negative_rate }}<br>
				<b>Precision</b>: {{ performance.precision }}<br>
				<b>Negative predictive value</b>: {{ performance.negative_predictive_value }}<br>
				<b>False discovery rate</b>: {{ performance.false_discovery_rate }}<br>
				<b>False omission rate</b>: {{ performance.false_omission_rate }}<br>
				<b>Accuracy</b>: {{ performance.accuracy }}<br>
			</div>
			<div>
				<h2>Classification metrics</h2>
				<b>Error rate</b>: {{ classify.error_rate }}<br>
				<b>Average odds difference</b>: {{ classify.average_odds_difference }}<br>
				<b>Average abs odds difference</b>: {{ classify.average_abs_odds_difference }}<br>
				<b>Selection rate</b>: {{ classify.selection_rate }}<br>
				<b>Disparate impact</b>: {{ classify.disparate_impact }}<br>
				<b>Statistical parity difference</b>: {{ classify.statistical_parity_difference }}<br>
				<b>Generalized entropy index</b>: {{ classify.generalized_entropy_index }}<br>
				<b>Theil index</b>: {{ classify.theil_index }}<br>
				<b>Equal opportunity difference</b>: {{ classify.equal_opportunity_difference }}<br>
			</div>
		</div>
		<h1>Bias charts</h1>
		<div>
			<!-- Bias chart area -->
			<h2>Data metrics chart</h2>
			<figure class="highcharts-figure">
				<div>
					<div id="data_n_bar" class="bar"></div>
					<div id="data_n_bar3d" class="bar3d"></div>
					<div id="data_chart_bar" class="bar"></div>
				</div>
			</figure>
			<h2>Performance chart</h2>
			<figure class="highcharts-figure">
				<div>
					<div id="performance_chart_bar" class="bar"></div>
				</div>
			</figure>
			<h2>Classification metrics chart</h2>
			<figure class="highcharts-figure">
				<div>
					<div id="cls_chart_bar" class="bar"></div>
				</div>
			</figure>
		</div>

		<!-- Bias chart script -->
		<script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
		<script type="text/javascript" src="https://code.highcharts.com/highcharts-3d.js"></script>
		<script type="text/javascript" src="https://code.highcharts.com/highcharts-more.js"></script>
		<script type="text/javascript" src="/static/src/bias_chart.js"></script>

		<!-- Resource Script -->
		<script type="text/javascript">
			const n_privileged = [{{ data.privileged.num_negatives }}, {{ data.privileged.num_positives }}];
			const n_unprivileged = [{{ data.unprivileged.num_negatives }}, {{ data.unprivileged.num_positives }}];

			const dataN_xAxis = ["Number of negatives", "Number of positives"];

			const dataNBar = new BarChart("data_n_bar");
			dataNBar.setAxis(dataN_xAxis);
			dataNBar.push(n_privileged, {name: "Privileged", color: "#FF0000bb"});
			dataNBar.push(n_unprivileged, {name: "Unprivileged"});
			dataNBar.show();

			const dataNBar3d = new BarChart3D("data_n_bar3d");
			dataNBar3d.setAxis(dataN_xAxis);
			dataNBar3d.push(n_privileged, {name: "Privileged", color: "#FF0000bb"});
			dataNBar3d.push(n_unprivileged, {name: "Unprivileged"});
			dataNBar3d.show();

			const dataMeasure = [
				{{ data.base_rate }},
				{{ data.statistical_parity_difference }},
				{{ data.consistency }}
			];
			const dataMeasure_xAxis = ["Base rate", "Statistical parity difference", "Consistency"];

			const performanceMeasure = [
				{{ performance.true_negative_rate }},
				{{ performance.false_positive_rate }},
				{{ performance.false_negative_rate }},
				{{ performance.recall }},
				{{ performance.precision }},
				{{ performance.negative_predictive_value }},
				{{ performance.false_discovery_rate }},
				{{ performance.false_omission_rate }},
				{{ performance.accuracy }}
			];
			const performanceMeasure_xAxis = ["TNR", "FPR", "FNR", "Recall", "Precision", "NPV", "FDR", "FOR", "ACC"];

			const clsMeasure = [
				{{ classify.average_odds_difference }},
				{{ classify.selection_rate }},
				{{ classify.disparate_impact }},
				{{ classify.statistical_parity_difference }},
				{{ classify.theil_index }},
				{{ classify.equal_opportunity_difference }}
			];
			const clsMeasure_xAxis = ["Average odds difference", "Selection rate", "Disparate impact", "Statistical parity difference", "Theil index", "Equal opportunity difference"];


			const dataBar = new BarChart("data_chart_bar");
			dataBar.setAxis(dataMeasure_xAxis);
			dataBar.push(dataMeasure, {name: "Data Measure"});
			dataBar.show();

			const performanceBar = new BarChart("performance_chart_bar");
			performanceBar.setAxis(performanceMeasure_xAxis);
			performanceBar.push(performanceMeasure, {name: "Performance"});
			performanceBar.show();

			const clsBar = new BarChart("cls_chart_bar");
			clsBar.setAxis(clsMeasure_xAxis);
			clsBar.push(clsMeasure, {name: "Bias Measure"});
			clsBar.show();
		</script>
		<a href="/data">Prev</a>
		<a href="/algorithm/{{data_name}}">Next</a>
	</body>
</html>